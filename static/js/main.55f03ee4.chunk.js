(this["webpackJsonpcred-wallet-emulator"]=this["webpackJsonpcred-wallet-emulator"]||[]).push([[0],{123:function(e,t){},142:function(e,t){},211:function(e,t){},216:function(e,t){},217:function(e,t){},220:function(e,t){},231:function(e,t,n){},316:function(e,t){},321:function(e,t){},346:function(e,t,n){},364:function(e,t){},373:function(e,t){},381:function(e,t){},382:function(e,t){},387:function(e,t){},389:function(e,t){},399:function(e,t){},401:function(e,t){},426:function(e,t){},427:function(e,t){},432:function(e,t){},434:function(e,t){},441:function(e,t){},460:function(e,t){},514:function(e,t){},522:function(e,t){},523:function(e,t){},548:function(e,t){},549:function(e,t){},550:function(e,t){},565:function(e,t,n){"use strict";n.r(t);var i=n(16),a=n(0),r=n.n(a),o=n(38),c=n.n(o),l=(n(346),n(231),n(14)),s=n(1),h=n.n(s),u=n(3),d=n(108),b=n(601),j=n(602),g=n(603),p=n(172),f=n(604),w=n(595),O=n(598),m=n(599),x=n(600),y=n(41),v=n(323),k=n.n(v),S=n(327),W={id:"did:web:digitalcredentials.github.io",publicKey:[{id:"did:web:digitalcredentials.github.io#96K4BSIWAkhcclKssb8yTWMQSz4QzPWBy-JsAFlwoIs",type:"JsonWebKey2020",controller:"did:web:digitalcredentials.github.io",publicKeyJwk:{kid:"96K4BSIWAkhcclKssb8yTWMQSz4QzPWBy-JsAFlwoIs",kty:"OKP",crv:"Ed25519",x:"NCqHLgxwYX0GJO2phSUBHZ-w0Tr5sblr7bCZHZ2ld_I"},privateKeyJwk:{kid:"96K4BSIWAkhcclKssb8yTWMQSz4QzPWBy-JsAFlwoIs",kty:"OKP",crv:"Ed25519",x:"NCqHLgxwYX0GJO2phSUBHZ-w0Tr5sblr7bCZHZ2ld_I",d:"dp3-PUAIbYgyHSrCJtelS0vTrkBGMcqOulYmEi_QPmI"}}],authentication:["did:web:digitalcredentials.github.io#96K4BSIWAkhcclKssb8yTWMQSz4QzPWBy-JsAFlwoIs"],assertionMethod:["did:web:digitalcredentials.github.io#96K4BSIWAkhcclKssb8yTWMQSz4QzPWBy-JsAFlwoIs"],capabilityDelegation:["did:web:digitalcredentials.github.io#96K4BSIWAkhcclKssb8yTWMQSz4QzPWBy-JsAFlwoIs"],capabilityInvocation:["did:web:digitalcredentials.github.io#96K4BSIWAkhcclKssb8yTWMQSz4QzPWBy-JsAFlwoIs"],"@context":"https://www.w3.org/ns/did/v1"};console.log(W);var B=W,C=Object(w.a)((function(e){return{root:{maxWidth:1e3},multiline:{fontWeight:"bold",fontSize:"20px",color:"purple",width:"50vw"},textfield:{width:"60vw"}}})),q={bgcolor:"background.paper",m:4,p:4,border:1,borderColor:"text.primary",borderRadius:16};var I=function(){var e=C(),t=Object(y.f)(),n=Object(a.useState)(""),o=Object(d.a)(n,2),c=o[0],s=o[1],w=Object(a.useState)(""),v=Object(d.a)(w,2),W=v[0],I=v[1],T=Object(a.useState)("http://localhost:4010/request?student_id=400000002&batch=first&redirect_uri=http://localhost:3000/wallet"),A=Object(d.a)(T,2),P=A[0],K=A[1],J=Object(a.useState)(""),z=Object(d.a)(J,2),D=z[0],Q=z[1],R=Object(a.useState)(""),_=Object(d.a)(R,2),N=_[0],M=_[1],F=Object(a.useState)(1),V=Object(d.a)(F,2),H=V[0],E=V[1],Y=function(){var e=Object(u.a)(h.a.mark((function e(){var t,n,i,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"323",t={verificationMethod:"did:web:digitalcredentials.github.io#96K4BSIWAkhcclKssb8yTWMQSz4QzPWBy-JsAFlwoIs",challenge:c},n=B.id,i=Object(S.a)(B),e.next=6,i.createAndSignPresentation(null,"323",n,t);case 6:a=e.sent,Q(JSON.stringify(a,null,2)),E(3);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=Object(u.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(D),e.next=3,fetch(W,{method:"POST",mode:"cors",body:D,headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}));case 3:t=e.sent,M(JSON.stringify(t.credential,null,2)),E(4);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(e){return H===e?"lightgreen":"background.paper"},G=function(e){return H===e?Object(i.jsx)(f.a,{fontWeight:"fontWeightBold",m:3,children:"You appear to be on this step"}):null};return r.a.useEffect((function(){var e=k.a.parse(t.search);e.request_url&&e.challenge?(E(2),s(e.challenge),I(e.request_url)):E(1)}),[t]),Object(i.jsx)(f.a,{display:"flex",justifyContent:"center",m:1,p:1,children:Object(i.jsx)("div",{className:"App",children:Object(i.jsxs)(f.a,{className:e.root,children:[Object(i.jsx)(p.a,{variant:"h4",gutterBottom:!0,children:"Digital Credentials Consortium Wallet Simulator"}),Object(i.jsxs)(p.a,{children:["Use this page to simulate the exchange between the recipient (normally on a mobile) and the issuer.  This page plays the part of the recipient's phone, especially the Wallet on their phone.  The idea here is to test the issuing server.  The exchange follows the Digital Credential Consortium's ",Object(i.jsx)("a",{href:"https://github.com/digitalcredentials/docs/blob/main/request/credential_request.md",children:"Credential Request Flow"})]}),Object(i.jsxs)(f.a,Object(l.a)(Object(l.a)({},q),{},{bgcolor:U(1),children:[Object(i.jsx)(p.a,{variant:"h5",gutterBottom:!0,children:"Step 1 - Initiate Exchange"}),G(1),Object(i.jsx)(p.a,{gutterBottom:!0,children:"At this point in the exchange (the beginning), a link will have been given (e.g., emailed) to the student, like the link below in the 'Initiate Credential Request' field (note the query params on the link). The student would click this link (in the email) while on their phone, which would send the request to the issuer's server to start the issuance exchange.  The link will likely first take the student to some authentication page (and so open a web browser on the phone). After authentication the issuer will generate a one time token/challenge, maybe verify the user is entitled to a credential, and then redirect the request to the redirect_uri that was included as a query parameter on the original link, adding on two additional query parameters to that link:"}),Object(i.jsx)(f.a,{display:"flex",justifyContent:"center",m:1,p:1,children:Object(i.jsxs)(O.a,{component:"nav","aria-label":"secondary mailbox folders",children:[Object(i.jsx)(m.a,{children:Object(i.jsx)(x.a,{inset:!0,primary:"challenge=valueOfToken",secondary:"One time token generated by the issuer."})}),Object(i.jsx)(m.a,{button:!0,children:Object(i.jsx)(x.a,{inset:!0,primary:"request_url=http://....",secondary:"The url from which the wallet should request the credential."})})]})}),Object(i.jsx)(p.a,{gutterBottom:!0,children:"Normally the redirect_uri would be a deep link that opens the Wallet on the recipient's phone, but we instead make it point to this page, like in the example url below. Change the example url below to match what you need, e.g., change the server location to yours, possibly the link in the redirect_uri (if for example you are hosting a copy of this page), and add in any other query parameters that your issuing server expects.  Then click the button to send off the request.  It should end up right back at this page (after the redirect), but at Step 2 below."}),Object(i.jsx)(f.a,{m:3,children:Object(i.jsxs)(b.a,{children:[" ",Object(i.jsx)(g.a,{className:e.textfield,p:3,label:"Initiate Credential Request",value:P,onChange:function(e){return K(e.currentTarget.value)}})]})}),Object(i.jsx)(f.a,{m:1,children:Object(i.jsx)(j.a,{variant:"outlined",color:"primary",onClick:function(){window.location.href=P},children:"Send Initial Request"})})]})),Object(i.jsxs)(f.a,Object(l.a)(Object(l.a)({},q),{},{p:4,bgcolor:U(2),children:[Object(i.jsx)(p.a,{variant:"h5",gutterBottom:!0,children:"Step 2 - Redirected into Wallet - Now Build and Sign VerifiablePresentation"}),G(2),Object(i.jsxs)(p.a,{gutterBottom:!0,children:["The issuer's server has redirected our intial request from 1 (after authenticating us and generating a one-time token/challenge) to the the redirect_uri that we supplied as part of the initial url above.  The 'challenge' and 'request_url' that the server has sent us are shown below.  Now our job (well, the Wallet's job) is to construct a VerifiablePresentation that includes that challenge, sign the VP, and send it to the request_url.  This does a few things:",Object(i.jsxs)(O.a,{component:"nav","aria-label":"secondary mailbox folders",children:[Object(i.jsx)(m.a,{button:!0,children:Object(i.jsx)(x.a,{primary:"Submits our DID",secondary:"Gives our DID to the server so it can be included in our credential"})}),Object(i.jsx)(m.a,{button:!0,children:Object(i.jsx)(x.a,{primary:"Proves DID ownership",secondary:"We sign the VP with our private key proving we own the DID"})}),Object(i.jsx)(m.a,{button:!0,children:Object(i.jsx)(x.a,{primary:"Proves identity",secondary:"Because we include the token we got from authenticating earlier"})})]}),"This Wallet uses a hardcoded unlocked DID to sign the Verifiable Presentation (so is only for demonstation). When you are ready, click Build Collection Request to have this Wallet emulator construct and sign the VP (but not send it - that's the next step)."]}),Object(i.jsx)("div",{children:Object(i.jsx)(b.a,{children:Object(i.jsx)(g.a,{label:"Request URL",value:W,onChange:function(e){return I(e.currentTarget.value)},className:e.textfield})})}),Object(i.jsx)("div",{children:Object(i.jsxs)(b.a,{children:[" ",Object(i.jsx)(g.a,{label:"Challenge",value:c,onChange:function(e){return s(e.currentTarget.value)},className:e.textfield})]})}),Object(i.jsx)(f.a,{p:3,children:Object(i.jsx)(j.a,{variant:"outlined",color:"primary",onClick:Y,children:"Build and Sign Collection Request"})})]})),Object(i.jsxs)(f.a,Object(l.a)(Object(l.a)({},q),{},{bgcolor:U(3),children:[Object(i.jsx)(p.a,{variant:"h5",gutterBottom:!0,children:"Step 3 - Collect the Credential"}),G(3),Object(i.jsx)(p.a,{gutterBottom:!0,children:"Okay then, we (the Wallet) have now constructed our signed Verifiable Presentation (as shown below). Now you can click 'Send Cred Request' to ship it off to the issuer's server and hopefuly get back our credential (to be shown in the next step).  The server will verify the VP signature,  check that the challenge matches, check that the recipient is in fact entitled to a certificate, construct the certificate, sign it, and send it back."}),Object(i.jsx)(f.a,{p:3,children:Object(i.jsxs)(b.a,{children:[" ",Object(i.jsx)(g.a,{className:e.multiline,id:"outlined-multiline-static",label:"DID-Auth-response to send to issuer",multiline:!0,rows:23,variant:"outlined",placeholder:"Your DID Auth Response will appear here after you click 'Build Cred Request'",value:D,onChange:function(e){return Q(e.currentTarget.value)}})]})}),Object(i.jsxs)(p.a,{gutterBottom:!0,children:["Click 'Send Cred Request' to send the signed verifiable presentation to ",Object(i.jsx)(f.a,{fontWeight:"fontWeightBold",children:W})," (the 'request_url the issuer gave us back in Step 2 when it redirected us into the wallet), to collect our credential.  Again, this request would normally be sent by the wallet."]}),Object(i.jsx)(f.a,{p:3,children:Object(i.jsx)(j.a,{variant:"outlined",color:"primary",onClick:Z,children:"Send Cred Request"})})]})),Object(i.jsxs)(f.a,Object(l.a)(Object(l.a)({},q),{},{bgcolor:U(4),children:[Object(i.jsx)(p.a,{variant:"h5",gutterBottom:!0,children:"Step 4 - Admire the Credential"}),G(4),Object(i.jsx)(p.a,{gutterBottom:!0,children:"Okay, okay now - we've got our credential!  The Wallet would now store it away for future sharing/admiration."}),Object(i.jsx)("div",{children:Object(i.jsxs)(b.a,{children:[" ",Object(i.jsx)(g.a,{className:e.multiline,id:"outlined-multiline-static",label:"Returned Credential",multiline:!0,rows:30,variant:"outlined",placeholder:"The returned credential will be shown here after you click Send Cred Request",value:N,onChange:function(e){return M(e.currentTarget.value)}})]})})]}))]})})})},T=n(221);var A=function(){return Object(i.jsx)(T.a,{children:Object(i.jsx)(y.c,{children:Object(i.jsx)(y.a,{path:"/",children:Object(i.jsx)(I,{})})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(A,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[565,1,2]]]);
//# sourceMappingURL=main.55f03ee4.chunk.js.map